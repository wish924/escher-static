function init(){var e=document.getElementById("loading");e.style.display="none";var n,t;n=document.getElementById("container"),camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1100),camera.target=new THREE.Vector3(0,0,0),scene=new THREE.Scene;var i=new THREE.SphereBufferGeometry(500,60,40);i.scale(-1,1,1);var o=document.createElement("video");o.loop=!0,o.muted=!0,o.autoplay=!0,o.crossOrigin="",o.src="http://obfgoys2n.bkt.clouddn.com/xiaomi_VR_preview_727_2.mp4";var a=new THREE.VideoTexture(o);a.minFilter=THREE.LinearFilter,a.format=THREE.RGBFormat;var r=new THREE.MeshBasicMaterial({map:a});t=new THREE.Mesh(i,r),scene.add(t),renderer=new THREE.WebGLRenderer,renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),n.appendChild(renderer.domElement),document.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("mousewheel",onDocumentMouseWheel,!1),document.addEventListener("MozMousePixelScroll",onDocumentMouseWheel,!1),window.addEventListener("resize",onWindowResize,!1)}function onDocumentMouseMove(e){e.preventDefault(),(isUserInteracting=!1)&&(onPointerDownPointerX=e.clientX,onPointerDownPointerY=e.clientY),isUserInteracting=!0,isUserInteracting===!0&&(lon=.1*(onPointerDownPointerX-e.clientX)+lon,lat=.1*(e.clientY-onPointerDownPointerY)+lat),onPointerDownPointerX=e.clientX,onPointerDownPointerY=e.clientY,isUserInteracting=!1}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function onDocumentMouseWheel(e){var n=500/Math.sqrt(Math.pow(Math.tan(THREE.Math.degToRad(camera.fov/2)),2)*(1+Math.pow(window.innerHeight/window.innerWidth,2)))-6;e.wheelDeltaY?calDistance(e.wheelDeltaY,n):e.wheelDelta?calDistance(e.wheelDelta,n):e.detail&&calDistance(e.detail,n)}function calDistance(e,n){distance<n&&distance+500<camera.far&&distance>10?distance-=.05*e:distance>=n?e>0&&(distance-=.05*e):event.wheelDeltaY<0&&(distance-=.05*event.wheelDeltaY)}function animate(){requestAnimationFrame(animate),update()}function update(){lat=Math.max(-85,Math.min(85,lat)),phi=THREE.Math.degToRad(90-lat),theta=THREE.Math.degToRad(lon),camera.position.x=distance*Math.sin(phi)*Math.cos(theta),camera.position.y=distance*Math.cos(phi),camera.position.z=distance*Math.sin(phi)*Math.sin(theta),camera.lookAt(camera.target),renderer.render(scene,camera)}var onPointerDownPointerX=window.innerWidth/2,onPointerDownPointerY=window.innerHeight/2,camera,scene,renderer,texture_placeholder,isUserInteracting=!1,onMouseDownMouseX=0,onMouseDownMouseY=0,lon=0,onMouseDownLon=0,lat=0,onMouseDownLat=0,phi=0,theta=0,distance=500;document.addEventListener("DOMContentLoaded",function(){$("body").vegas({slides:[{src:"/img/web/bg.jpg"}]}),document.getElementById("prefetch").addEventListener("load",function(){init(),animate()})},!1);